2022-05-23 16:28:08,274 - root - INFO - Namespace(seed=2019, data_name='movie-1m', data_dir='datasets/', use_pretrain=0, pretrain_embedding_dir='datasets/pretrain/', pretrain_model_path='trained_model/model.pth', cf_batch_size=1024, kg_batch_size=2048, test_batch_size=10000, embed_dim=64, relation_dim=64, laplacian_type='random-walk', aggregation_type='bi-interaction', conv_dim_list='[64, 32, 16]', mess_dropout='[0.1, 0.1, 0.1]', kg_l2loss_lambda=1e-05, cf_l2loss_lambda=1e-05, lr=0.0001, n_epoch=1000, stopping_steps=10, cf_print_every=1, kg_print_every=1, evaluate_every=1, Ks='[20, 40, 60, 80, 100]', save_dir='trained_model/KGAT/movie-1m/embed-dim64_relation-dim64_random-walk_bi-interaction_64-32-16_lr0.0001_pretrain0/')
2022-05-23 16:28:43,131 - root - INFO - n_users:           6036
2022-05-23 16:28:43,131 - root - INFO - n_items:           2445
2022-05-23 16:28:43,131 - root - INFO - n_entities:        47886
2022-05-23 16:28:43,131 - root - INFO - n_users_entities:  53922
2022-05-23 16:28:43,131 - root - INFO - n_relations:       52
2022-05-23 16:28:43,131 - root - INFO - n_h_list:          1331278
2022-05-23 16:28:43,131 - root - INFO - n_t_list:          1331278
2022-05-23 16:28:43,131 - root - INFO - n_r_list:          1331278
2022-05-23 16:28:43,131 - root - INFO - n_cf_train:        525095
2022-05-23 16:28:43,131 - root - INFO - n_cf_test:         228677
2022-05-23 16:28:43,131 - root - INFO - n_kg_train:        1331278
2022-05-23 16:28:47,196 - root - INFO - KGAT(
  (entity_user_embed): Embedding(53922, 64)
  (relation_embed): Embedding(52, 64)
  (aggregator_layers): ModuleList(
    (0): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
    )
    (1): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (linear1): Linear(in_features=64, out_features=32, bias=True)
      (linear2): Linear(in_features=64, out_features=32, bias=True)
    )
    (2): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (linear1): Linear(in_features=32, out_features=16, bias=True)
      (linear2): Linear(in_features=32, out_features=16, bias=True)
    )
  )
)
2022-05-23 16:29:50,233 - root - INFO - Update Attention: Epoch 0001 | Total Time 0.1s
2022-05-23 16:29:50,233 - root - INFO - CF + KG Training: Epoch 0001 | Total Time 63.0s
2022-05-23 16:29:50,960 - root - INFO - CF Evaluation: Epoch 0001 | Total Time 0.7s | Precision [0.0165, 0.0163], Recall [0.0080, 0.0420], NDCG [0.0172, 0.0290]
2022-05-23 16:29:51,010 - root - INFO - Save model on epoch 0001!
2022-05-23 16:30:23,663 - root - INFO - Update Attention: Epoch 0002 | Total Time 0.1s
2022-05-23 16:30:23,663 - root - INFO - CF + KG Training: Epoch 0002 | Total Time 32.7s
2022-05-23 16:30:24,386 - root - INFO - CF Evaluation: Epoch 0002 | Total Time 0.7s | Precision [0.0152, 0.0151], Recall [0.0078, 0.0393], NDCG [0.0162, 0.0274]
2022-05-23 16:31:51,139 - root - INFO - Update Attention: Epoch 0003 | Total Time 0.2s
2022-05-23 16:31:51,140 - root - INFO - CF + KG Training: Epoch 0003 | Total Time 86.8s
2022-05-23 16:31:52,233 - root - INFO - CF Evaluation: Epoch 0003 | Total Time 1.1s | Precision [0.0150, 0.0151], Recall [0.0079, 0.0395], NDCG [0.0161, 0.0274]
2022-05-23 16:33:09,348 - root - INFO - Update Attention: Epoch 0004 | Total Time 0.2s
2022-05-23 16:33:09,348 - root - INFO - CF + KG Training: Epoch 0004 | Total Time 77.1s
2022-05-23 16:33:10,131 - root - INFO - CF Evaluation: Epoch 0004 | Total Time 0.8s | Precision [0.0149, 0.0150], Recall [0.0080, 0.0396], NDCG [0.0161, 0.0274]
2022-05-23 16:34:14,776 - root - INFO - Update Attention: Epoch 0005 | Total Time 0.2s
2022-05-23 16:34:14,776 - root - INFO - CF + KG Training: Epoch 0005 | Total Time 64.6s
2022-05-23 16:34:15,548 - root - INFO - CF Evaluation: Epoch 0005 | Total Time 0.8s | Precision [0.0151, 0.0148], Recall [0.0082, 0.0394], NDCG [0.0161, 0.0271]
2022-05-23 16:34:15,585 - root - INFO - Save model on epoch 0005!
2022-05-23 16:35:19,420 - root - INFO - Update Attention: Epoch 0006 | Total Time 0.2s
2022-05-23 16:35:19,420 - root - INFO - CF + KG Training: Epoch 0006 | Total Time 63.8s
2022-05-23 16:35:20,199 - root - INFO - CF Evaluation: Epoch 0006 | Total Time 0.8s | Precision [0.0147, 0.0149], Recall [0.0078, 0.0392], NDCG [0.0156, 0.0269]
2022-05-23 16:36:23,130 - root - INFO - Update Attention: Epoch 0007 | Total Time 0.1s
2022-05-23 16:36:23,130 - root - INFO - CF + KG Training: Epoch 0007 | Total Time 62.9s
2022-05-23 16:36:23,875 - root - INFO - CF Evaluation: Epoch 0007 | Total Time 0.7s | Precision [0.0146, 0.0148], Recall [0.0079, 0.0391], NDCG [0.0155, 0.0268]
2022-05-23 16:37:26,545 - root - INFO - Update Attention: Epoch 0008 | Total Time 0.1s
2022-05-23 16:37:26,545 - root - INFO - CF + KG Training: Epoch 0008 | Total Time 62.7s
2022-05-23 16:37:27,304 - root - INFO - CF Evaluation: Epoch 0008 | Total Time 0.8s | Precision [0.0145, 0.0147], Recall [0.0079, 0.0392], NDCG [0.0154, 0.0269]
2022-05-23 16:38:53,274 - root - INFO - Update Attention: Epoch 0009 | Total Time 0.2s
2022-05-23 16:38:53,274 - root - INFO - CF + KG Training: Epoch 0009 | Total Time 86.0s
2022-05-23 16:38:54,371 - root - INFO - CF Evaluation: Epoch 0009 | Total Time 1.1s | Precision [0.0141, 0.0146], Recall [0.0077, 0.0388], NDCG [0.0150, 0.0266]
2022-05-23 16:40:20,579 - root - INFO - Update Attention: Epoch 0010 | Total Time 0.2s
2022-05-23 16:40:20,579 - root - INFO - CF + KG Training: Epoch 0010 | Total Time 86.2s
2022-05-23 16:40:21,341 - root - INFO - CF Evaluation: Epoch 0010 | Total Time 0.8s | Precision [0.0136, 0.0144], Recall [0.0076, 0.0384], NDCG [0.0143, 0.0261]
2022-05-23 16:41:27,105 - root - INFO - Update Attention: Epoch 0011 | Total Time 0.2s
2022-05-23 16:41:27,105 - root - INFO - CF + KG Training: Epoch 0011 | Total Time 65.8s
2022-05-23 16:41:27,871 - root - INFO - CF Evaluation: Epoch 0011 | Total Time 0.8s | Precision [0.0137, 0.0143], Recall [0.0077, 0.0383], NDCG [0.0143, 0.0260]
