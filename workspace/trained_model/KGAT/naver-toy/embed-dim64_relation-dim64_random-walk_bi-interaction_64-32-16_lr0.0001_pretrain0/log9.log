2022-05-13 18:43:26,573 - root - INFO - Namespace(seed=2019, data_name='naver-toy', data_dir='datasets/', use_pretrain=0, pretrain_embedding_dir='datasets/pretrain/', pretrain_model_path='trained_model/model.pth', cf_batch_size=1024, kg_batch_size=2048, test_batch_size=10000, embed_dim=64, relation_dim=64, laplacian_type='random-walk', aggregation_type='bi-interaction', conv_dim_list='[64, 32, 16]', mess_dropout='[0.1, 0.1, 0.1]', kg_l2loss_lambda=1e-05, cf_l2loss_lambda=1e-05, lr=0.0001, n_epoch=1000, stopping_steps=10, cf_print_every=1, kg_print_every=1, evaluate_every=10, Ks='[20, 40, 60, 80, 100]', save_dir='trained_model/KGAT/naver-toy/embed-dim64_relation-dim64_random-walk_bi-interaction_64-32-16_lr0.0001_pretrain0/')
2022-05-13 18:43:31,596 - root - INFO - n_users:           13498
2022-05-13 18:43:31,596 - root - INFO - n_items:           7285
2022-05-13 18:43:31,596 - root - INFO - n_entities:        7348
2022-05-13 18:43:31,596 - root - INFO - n_users_entities:  20846
2022-05-13 18:43:31,596 - root - INFO - n_relations:       8
2022-05-13 18:43:31,596 - root - INFO - n_h_list:          181028
2022-05-13 18:43:31,596 - root - INFO - n_t_list:          181028
2022-05-13 18:43:31,597 - root - INFO - n_r_list:          181028
2022-05-13 18:43:31,597 - root - INFO - n_cf_train:        68659
2022-05-13 18:43:31,597 - root - INFO - n_cf_test:         27569
2022-05-13 18:43:31,597 - root - INFO - n_kg_train:        181028
2022-05-13 18:43:33,280 - root - INFO - KGAT(
  (entity_user_embed): Embedding(20846, 64)
  (relation_embed): Embedding(8, 64)
  (aggregator_layers): ModuleList(
    (0): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
    )
    (1): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (linear1): Linear(in_features=64, out_features=32, bias=True)
      (linear2): Linear(in_features=64, out_features=32, bias=True)
    )
    (2): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (linear1): Linear(in_features=32, out_features=16, bias=True)
      (linear2): Linear(in_features=32, out_features=16, bias=True)
    )
  )
)
2022-05-13 18:43:36,521 - root - INFO - Update Attention: Epoch 0001 | Total Time 0.0s
2022-05-13 18:43:36,521 - root - INFO - CF + KG Training: Epoch 0001 | Total Time 3.2s
2022-05-13 18:43:40,498 - root - INFO - CF Evaluation: Epoch 0001 | Total Time 4.0s | Precision [0.0005, 0.0004], Recall [0.0039, 0.0144], NDCG [0.0018, 0.0042]
2022-05-13 18:43:40,510 - root - INFO - Save model on epoch 0001!
2022-05-13 18:43:43,199 - root - INFO - Update Attention: Epoch 0002 | Total Time 0.0s
2022-05-13 18:43:43,199 - root - INFO - CF + KG Training: Epoch 0002 | Total Time 2.7s
2022-05-13 18:43:45,901 - root - INFO - Update Attention: Epoch 0003 | Total Time 0.0s
2022-05-13 18:43:45,901 - root - INFO - CF + KG Training: Epoch 0003 | Total Time 2.7s
2022-05-13 18:43:48,587 - root - INFO - Update Attention: Epoch 0004 | Total Time 0.0s
2022-05-13 18:43:48,587 - root - INFO - CF + KG Training: Epoch 0004 | Total Time 2.7s
2022-05-13 18:43:51,277 - root - INFO - Update Attention: Epoch 0005 | Total Time 0.0s
2022-05-13 18:43:51,277 - root - INFO - CF + KG Training: Epoch 0005 | Total Time 2.7s
2022-05-13 18:43:53,951 - root - INFO - Update Attention: Epoch 0006 | Total Time 0.0s
2022-05-13 18:43:53,951 - root - INFO - CF + KG Training: Epoch 0006 | Total Time 2.7s
2022-05-13 18:43:56,685 - root - INFO - Update Attention: Epoch 0007 | Total Time 0.0s
2022-05-13 18:43:56,685 - root - INFO - CF + KG Training: Epoch 0007 | Total Time 2.7s
2022-05-13 18:43:59,384 - root - INFO - Update Attention: Epoch 0008 | Total Time 0.0s
2022-05-13 18:43:59,385 - root - INFO - CF + KG Training: Epoch 0008 | Total Time 2.7s
2022-05-13 18:44:02,127 - root - INFO - Update Attention: Epoch 0009 | Total Time 0.0s
2022-05-13 18:44:02,127 - root - INFO - CF + KG Training: Epoch 0009 | Total Time 2.7s
2022-05-13 18:44:04,880 - root - INFO - Update Attention: Epoch 0010 | Total Time 0.0s
2022-05-13 18:44:04,880 - root - INFO - CF + KG Training: Epoch 0010 | Total Time 2.8s
2022-05-13 18:44:08,769 - root - INFO - CF Evaluation: Epoch 0010 | Total Time 3.9s | Precision [0.0026, 0.0014], Recall [0.0192, 0.0564], NDCG [0.0100, 0.0184]
2022-05-13 18:44:08,778 - root - INFO - Save model on epoch 0010!
2022-05-13 18:44:11,567 - root - INFO - Update Attention: Epoch 0011 | Total Time 0.0s
2022-05-13 18:44:11,567 - root - INFO - CF + KG Training: Epoch 0011 | Total Time 2.8s
2022-05-13 18:44:14,332 - root - INFO - Update Attention: Epoch 0012 | Total Time 0.0s
2022-05-13 18:44:14,332 - root - INFO - CF + KG Training: Epoch 0012 | Total Time 2.8s
2022-05-13 18:44:17,070 - root - INFO - Update Attention: Epoch 0013 | Total Time 0.0s
2022-05-13 18:44:17,070 - root - INFO - CF + KG Training: Epoch 0013 | Total Time 2.7s
2022-05-13 18:44:19,808 - root - INFO - Update Attention: Epoch 0014 | Total Time 0.0s
2022-05-13 18:44:19,808 - root - INFO - CF + KG Training: Epoch 0014 | Total Time 2.7s
2022-05-13 18:44:22,558 - root - INFO - Update Attention: Epoch 0015 | Total Time 0.0s
2022-05-13 18:44:22,558 - root - INFO - CF + KG Training: Epoch 0015 | Total Time 2.7s
2022-05-13 18:44:25,361 - root - INFO - Update Attention: Epoch 0016 | Total Time 0.0s
2022-05-13 18:44:25,361 - root - INFO - CF + KG Training: Epoch 0016 | Total Time 2.8s
